<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<meta charset="UTF-8"/>
    <link rel="stylesheet" type="text/css" href="resource/css/common.css"/>
    <link rel="stylesheet" type="text/css" href="resource/css/shopcar.css"/>
    <link rel="stylesheet" type="text/css" href="resource/font-awesome-4.7.0/css/font-awesome.css"/>
	</head>
	<body>
		<div class="nut-header"><a href="./index.html"><i class="fa fa-home"></i></a>购物车实战</div>
		<div class="nut-content" :style="contentstyle" v-cloak>
			<div class='nut-item'>
        <template v-if="list.length">
          <table :style='{"width":"90%"}'>
            <thead>
              <tr>
                <th><button :class="{'select-all':selectall,'del-all':delall}"></button></th>
                <th>编号</th>
                <th>商品名称</th>
                <th>商品单价</th>
                <th>购买数量</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="(item,index) in list">
                <td><input type="checkbox" :item='item.id' key='item.id' :checked="item.select"/></td>
                <td>{{ index+1 }}</td>
                <td>{{ item.name }}</td>
                <td>{{ item.price }}</td>
                <td>
                  <button @click="handlereduce(index)" :disabled="item.count === 1" :class="[btn]">-</button>
                  {{ item.count }}
                  <button @click="handleadd(index)" :class="[btn]">+</button>
                </td>
                <td>
                  <button @click="handleremove(index)" :class="[btn]">移除</button>
                </td>
              </tr>
            </tbody>
          </table>
          <div :style='{"margin-top":"24px"}'>总价:￥{{ totalprice }}</div>
        </template>
			</div>
		</div>
    <script src="resource/js/jquery-3.2.1/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="resource/js/vue.js" type="text/javascript" charset="utf-8"></script>
	<script>
		  var params = {
        list: [{id:1,name:'iphone 7',price:3188,count:1,select:false},
              {id:2,name:'iphone 8',price:4288,count:1,select:false},
              {id:3,name:'iphone 10',price:9188,count:1,select:false},
              {id:4,name:'iphone xr',price:6499,count:1,select:false},
              {id:5,name:'ipad pro',price:3289,count:1,select:false}
              ],
        btn:  'nut-btn',
        selectall: true,
        delall: false
			};
			var obj = new Vue({
				el: '.nut-content',
				data: params,
				computed:{
				  totalprice:function(){
            var total = 0;
            for(var i=0;i<this.list.length;i++){
              var item = this.list[i];
              if(item.select==true)
                total += item.price * item.count;
            }
            return total.toString().replace(/\B(?=(\d{3})+$)/g,',');
          }          
        },
        methods:{
          handlereduce: function(index){
            if(this.list[index].count ===1 ) return;
            this.list[index].count--;
          },
          handleadd: function(index){
            this.list[index].count++;
          },
          handleremove: function(index){
            this.list.splice(index,1);
          },
          contentstyle: function(){return {'height':$(window).height()-$('.nut-header').height()+'px'}} 
        }
			});
	</script>
    <script src="resource/js/common.js" type="text/javascript" charset="utf-8"></script>
    <script src="resource/js/shopcar.js" type="text/javascript" charset="utf-8"></script>
	</body>
</html>